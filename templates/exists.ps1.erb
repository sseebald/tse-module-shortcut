$shell = New-Object -COM WScript.Shell
$shortcut = $shell.CreateShortcut("<%= @lnk_path %>")

If ( ($shortcut.TargetPath -eq "<%= @target.gsub(%r{/}, '\\') %>")) { Exit 0 }
<% unless @arguments.nil? -%>
If ( ($shortcut.Arguments -eq "<%= @arguments %>")) { Exit 0 }
<% end -%>
<% unless @description.nil? -%>
If ( ($shortcut.Description -eq "<%= @description %>")) { Exit 0 }
<% end -%>
<% unless @working_directory.nil? -%>
If ( ($shortcut.WorkingDirectory -eq "<%= @working_directory.gsub(%r{/}, '\\') %>")) { Exit 0 }
<% end -%>
<% unless @icon_location.nil? -%>
If ( ($shortcut.IconLocation -eq "<%= @icon_location %>")) { Exit 0 }
<% end -%>
Exit 1
